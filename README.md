# –î–æ–º–∞—à–Ω—î –∑–∞–≤–¥–∞–Ω–Ω—è –¥–æ –¢–µ–º–∏ –ü–æ—Ä–æ–¥–∂—É–≤–∞–ª—å–Ω—ñ –ø–∞—Ç–µ—Ä–Ω–∏: –§–∞–±—Ä–∏–∫–∞ –π –ê–±—Å—Ç—Ä–∞–∫—Ç–Ω–∞ —Ñ–∞–±—Ä–∏–∫–∞

–£ —Ä–µ–∞–ª—å–Ω–∏—Ö –∑–∞—Å—Ç–æ—Å—É–Ω–∫–∞—Ö —Ä–æ–±–æ—Ç–∞ –∑ –ø–ª–∞—Ç—ñ–∂–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ ‚Äî —Ü–µ –∑–∞–≤–∂–¥–∏ –ø—Ä–æ –∑–º—ñ–Ω–Ω—ñ—Å—Ç—å, –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –π –º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å. –£ —Ü—å–æ–º—É –∑–∞–≤–¥–∞–Ω–Ω—ñ –≤–∏ –Ω–∞–≤—á–∏—Ç–µ—Å—è –≤—ñ–¥–¥—ñ–ª—è—Ç–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –æ–±‚Äô—î–∫—Ç—ñ–≤ –≤—ñ–¥ —ó—Ö –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **–ø–∞—Ç–µ—Ä–Ω—ñ–≤ Factory Method —ñ Abstract Factory**, —â–æ –¥–∞—î –∑–º–æ–≥—É –±—É–¥—É–≤–∞—Ç–∏ –≥–Ω—É—á–∫—ñ, –º–æ–¥—É–ª—å–Ω—ñ —Ç–∞ —Ä–æ–∑—à–∏—Ä—é–≤–∞–Ω—ñ —Å–∏—Å—Ç–µ–º–∏. –¶–µ –±–∞–∑–æ–≤–∏–π –∫—Ä–æ–∫ –¥–æ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä, —è–∫—ñ –ª–µ–≥–∫–æ –∞–¥–∞–ø—Ç—É—é—Ç—å—Å—è –ø—ñ–¥ –∑–º—ñ–Ω—É –±—ñ–∑–Ω–µ—Å-–≤–∏–º–æ–≥ —ñ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ–π.

### –û–ø–∏—Å –∑–∞–≤–¥–∞–Ω–Ω—è

–ù–µ–æ–±—Ö—ñ–¥–Ω–æ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —ñ–º—ñ—Ç–∞—Ü—ñ–π–Ω—É –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—É –ø–ª–∞—Ç—ñ–∂–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏, —è–∫–∞ –ø—ñ–¥—Ç—Ä–∏–º—É—î –∫—ñ–ª—å–∫–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ñ–≤: `Stripe`, `PayPal` —ñ `ApplePay`. –ö–æ–∂–µ–Ω –ø—Ä–æ–≤–∞–π–¥–µ—Ä —Ä–µ–∞–ª—ñ–∑—É—î –æ–¥–Ω–∞–∫–æ–≤—É —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å: `authorize ‚Üí capture ‚Üí refund`.

–ó–∞–≤–¥–∞–Ω–Ω—è –ø–æ–ª—è–≥–∞—î –≤ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—ñ –ø–∞—Ç–µ—Ä–Ω—ñ–≤ Factory Method —Ç–∞ Abstract Factory, —â–æ–±:

- –≤—ñ–¥–æ–∫—Ä–µ–º–∏—Ç–∏ –ª–æ–≥—ñ–∫—É —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –æ–±‚Äô—î–∫—Ç—ñ–≤;
- —Å–ø—Ä–æ—Å—Ç–∏—Ç–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Å–∏—Å—Ç–µ–º–∏ –Ω–æ–≤–∏–º–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏;
- –ø—Ä–∏—Ö–æ–≤–∞—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `new` –∑–∞ —Ñ–∞–±—Ä–∏—á–Ω–∏–º —à–∞—Ä–æ–º.

–¶–µ –∑–∞–≤–¥–∞–Ω–Ω—è –Ω–µ –ø–µ—Ä–µ–¥–±–∞—á–∞—î –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ä–µ–∞–ª—å–Ω–∏—Ö –ø–ª–∞—Ç—ñ–∂–Ω–∏—Ö —Å–∏—Å—Ç–µ–º —á–∏ SDK. –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø–ª–∞—Ç—ñ–∂–Ω–∏—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤ —î —ñ–º—ñ—Ç–∞—Ü—ñ—î—é —ñ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ `console.log`.

–ü—Ä–∏–∫–ª–∞–¥:

```tsx
console.log(`[Stripe] Authorizing $${amount}`);
...
console.log(`[ApplePay] Refunding transaction ${transactionId}`);
```

### –ó–∞–≤–¥–∞–Ω–Ω—è

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

```
/src
  /core
    PaymentProvider.ts        # –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–ª–∞—Ç—ñ–∂–Ω–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
    PaymentProviderFactory.ts # –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ñ–∞–±—Ä–∏–∫–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ñ–≤
  /providers
    /stripe
      StripePaymentProvider.ts # –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è Stripe –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
      StripeFactory.ts         # –§–∞–±—Ä–∏–∫–∞ –¥–ª—è Stripe
    /paypal
      PaypalPaymentProvider.ts # –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è PayPal –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
      PaypalFactory.ts         # –§–∞–±—Ä–∏–∫–∞ –¥–ª—è PayPal
    /apple
      ApplePaymentProvider.ts  # –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è Apple Pay –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
      AppleFactory.ts          # –§–∞–±—Ä–∏–∫–∞ –¥–ª—è Apple Pay
  /app
    PaymentContext.ts         # –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏
  main.ts                    # –ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
package.json
tsconfig.json
```

### –û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

- –£—Å—ñ –∫–ª–∞—Å–∏ `XxxPaymentProvider` —Ä–µ–∞–ª—ñ–∑—É—é—Ç—å `PaymentProvider`;
- –£—Å—ñ –∫–ª–∞—Å–∏ `XxxFactory` —Ä–µ–∞–ª—ñ–∑—É—é—Ç—å `PaymentProviderFactory`;
- –ö–ª–∞—Å `PaymentContext` –ø—Ä–∞—Ü—é—î –∑ –±—É–¥—å-—è–∫–æ—é —Ñ–∞–±—Ä–∏–∫–æ—é —á–µ—Ä–µ–∑ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å;
- –í `main.ts` —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ —Å—Ü–µ–Ω–∞—Ä—ñ–π –ø–æ–≤–Ω–æ–≥–æ –ø–ª–∞—Ç—ñ–∂–Ω–æ–≥–æ —Ü–∏–∫–ª—É –∑ –æ–±—Ä–∞–Ω–∏–º –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º;
- –í–µ—Å—å –∫–æ–¥ —Ç–∏–ø—ñ–∑–æ–≤–∞–Ω–æ, –≤—ñ–Ω –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `new` –ø–æ–∑–∞ —Ñ–∞–±—Ä–∏–∫–∞–º–∏, —ñ –ª–µ–≥–∫–æ —Ä–æ–∑—à–∏—Ä—é—î—Ç—å—Å—è.

## –ó–∞—Å—Ç–æ—Å–æ–≤–∞–Ω—ñ –ø–∞—Ç–µ—Ä–Ω–∏

### Factory Method

- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö –ø–ª–∞—Ç—ñ–∂–Ω–∏—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ñ–≤
- –ö–æ–∂–µ–Ω –ø—Ä–æ–≤–∞–π–¥–µ—Ä (Stripe, PayPal, Apple Pay) –º–∞—î —Å–≤–æ—é —Ñ–∞–±—Ä–∏–∫—É
- –§–∞–±—Ä–∏–∫–∏ —Ä–µ–∞–ª—ñ–∑—É—é—Ç—å —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å `PaymentProviderFactory`

### Abstract Factory

- –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å `PaymentProviderFactory` –≤–∏–∑–Ω–∞—á–∞—î —Å–ø–æ—Å—ñ–± —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ñ–≤
- –î–æ–∑–≤–æ–ª—è—î —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ —Å—ñ–º–µ–π—Å—Ç–≤–∞ –ø–æ–≤'—è–∑–∞–Ω–∏—Ö –æ–±'—î–∫—Ç—ñ–≤
- –ó–∞–±–µ–∑–ø–µ—á—É—î –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –ª–µ–≥–∫–æ –¥–æ–¥–∞–≤–∞—Ç–∏ –Ω–æ–≤—ñ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∏

## –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç—É

```bash
# –ó–∞–ø—É—Å–∫ –∑ Stripe –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º
npx ts-node src/main.ts stripe

# –ó–∞–ø—É—Å–∫ –∑ PayPal –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º
npx ts-node src/main.ts paypal

# –ó–∞–ø—É—Å–∫ –∑ Apple Pay –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º
npx ts-node src/main.ts apple
```

–ü—Ä–∏ –∑–∞–ø—É—Å–∫—É –ø—Ä–æ–≥—Ä–∞–º–∞:

1. –°—Ç–≤–æ—Ä—é—î –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—É —Ñ–∞–±—Ä–∏–∫—É –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
2. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–ª–∞—Ç–µ–∂—ñ–≤
3. –í–∏–∫–æ–Ω—É—î –ø–æ–≤–Ω–∏–π —Ü–∏–∫–ª –æ–ø–µ—Ä–∞—Ü—ñ–π (authorize, capture, refund)

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

–ü—Ä–æ—î–∫—Ç —Ä–µ–∞–ª—ñ–∑—É—î –ø–∞—Ç–µ—Ä–Ω–∏ Factory Method —ñ Abstract Factory –¥–ª—è –ø–ª–∞—Ç—ñ–∂–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏.

- `/core` ‚Äî —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏ PaymentProvider —Ç–∞ PaymentProviderFactory
- `/providers` ‚Äî —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó Stripe, PayPal, ApplePay
- `/app` ‚Äî –∫–ª–∞—Å PaymentContext
- `main.ts` ‚Äî –∑–∞–ø—É—Å–∫ —Å—Ü–µ–Ω–∞—Ä—ñ—é

## üß© –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –ø–∞—Ç–µ—Ä–Ω–∏

- Factory Method
- Abstract Factory

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫

npx ts-node src/main.ts stripe
npx ts-node src/main.ts paypal
npx ts-node src/main.ts apple

## ‚ñ∂Ô∏è –†–ï–ó–£–õ–¨–¢–ê–¢

![alt text](src/img/01.jpg)
